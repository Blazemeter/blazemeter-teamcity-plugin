clearWorkspaceAsRoot()
@Library ("jenkins_library") _

pipeline
{
    agent
    {
        kubernetes
        {
            label 'maven'
            defaultContainer 'maven'
        }
    }
    options
    {
        buildDiscarder(logRotator(daysToKeepStr: '20',numToKeepStr: '50'))
        ansiColor('xterm')
        timestamps()
    }
    stages
    {
        stage('Build Maven')
        {
            steps
            {
                sh """
                    mvn clean install -Djenkins.build.number=${BUILD_NUMBER}
                    """
            }
        }
    }
    post
    {
        always
        {
            archiveArtifacts artifacts: 'target/BlazeMeter.zip', onlyIfSuccessful: true
        }
    }
}
